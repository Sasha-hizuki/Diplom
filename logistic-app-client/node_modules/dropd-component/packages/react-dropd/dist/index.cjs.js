"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var React=_interopDefault(require("react")),PropTypes=_interopDefault(require("prop-types"));function _defineProperty(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function _extends(){return(_extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function _inheritsLoose(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n}function _objectWithoutPropertiesLoose(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function styleInject(e,n){void 0===n&&(n={});var t=n.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===t&&o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}var css=".dropd {\n  color: #7a8ca0;\n  user-select: none;\n  text-align: left;\n  min-width: 100px;\n  position: relative;\n  display: inline-flex; }\n  .dropd[data-open='true'] .dropd-caret {\n    transform: rotate(-180deg); }\n  .dropd * {\n    outline-width: 1px;\n    box-sizing: border-box;\n    outline-color: #3599e7; }\n\n.dropd-toggle {\n  margin: 0;\n  height: 43px;\n  width: 100%;\n  border: none;\n  padding: 10px;\n  display: flex;\n  cursor: pointer;\n  overflow: hidden;\n  font-weight: 300;\n  align-items: center;\n  outline-color: #fff;\n  white-space: no-wrap;\n  -webkit-appearance: none;\n  background-color: #ffffff;\n  border: 1px solid #e8ecf3;\n  background-color: transparent;\n  justify-content: space-between;\n  -webkit-tap-highlight-color: transparent; }\n  .dropd-toggle .dropd-caret {\n    width: 6px;\n    height: 100%;\n    display: flex;\n    margin-left: 20px;\n    transform: rotate(0);\n    transition: 300ms linear; }\n    .dropd-toggle .dropd-caret:focus {\n      outline: 0 none; }\n    .dropd-toggle .dropd-caret svg {\n      width: inherit;\n      height: inherit;\n      overflow: hidden; }\n      .dropd-toggle .dropd-caret svg use,\n      .dropd-toggle .dropd-caret svg path {\n        fill: currentColor; }\n\n.dropd-current {\n  color: #2c3c4f;\n  display: block;\n  overflow: hidden;\n  text-align: left;\n  position: relative;\n  white-space: nowrap; }\n\n.dropd-list {\n  left: 0;\n  top: 40px;\n  opacity: 0;\n  z-index: -9;\n  width: 100%;\n  padding: 5px 0;\n  margin: 2px 0 0;\n  list-style: none;\n  text-align: left;\n  box-shadow: none;\n  font-size: 0.9em;\n  min-width: 200px;\n  max-height: 300px;\n  position: absolute;\n  border-radius: 4px;\n  pointer-events: none;\n  transform-origin: top;\n  overflow: hidden auto;\n  border: 1px solid #e8ecf3;\n  background-color: #ffffff;\n  transform: scaleY(0.8) translateY(-10px);\n  transition: 250ms 100ms, box-shadow 200ms 100ms; }\n  .dropd-list.open {\n    opacity: 1;\n    z-index: 1000;\n    pointer-events: auto;\n    transform: scaleY(1) translateY(0px);\n    box-shadow: 0 4px 10px rgba(32, 49, 70, 0.08); }\n  .dropd-list .dropd-item {\n    margin: 0;\n    width: 100%;\n    display: block;\n    color: #7a8ca0;\n    list-style: none;\n    text-align: left;\n    overflow: hidden;\n    position: relative;\n    font-weight: normal;\n    white-space: nowrap;\n    transition: background 300ms, color 100ms; }\n    .dropd-list .dropd-item:hover {\n      color: #2c3c4f;\n      background: #f9fafc; }\n    .dropd-list .dropd-item a {\n      display: block;\n      color: inherit;\n      cursor: pointer;\n      color: inherit;\n      line-height: 1.6;\n      padding: 10px 20px;\n      white-space: initial; }\n";styleInject(css);var Dropd=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return _defineProperty(_assertThisInitialized(n=e.call.apply(e,[this].concat(o))||this),"dropdRef",React.createRef()),_defineProperty(_assertThisInitialized(n),"listRef",React.createRef()),_defineProperty(_assertThisInitialized(n),"state",{list:[],open:!1,currentItem:null,defaultOpen:!1,revealOn:"mousedown"}),_defineProperty(_assertThisInitialized(n),"_isDropdElem",function(e){return-1!==e.indexOf(n.dropdRef.current)}),_defineProperty(_assertThisInitialized(n),"_emit",function(e,t,o){var r=new CustomEvent(e,{detail:t});n.dropdRef.current.dispatchEvent(r),"function"==typeof o&&o.call(_assertThisInitialized(n),t)}),_defineProperty(_assertThisInitialized(n),"_emitOpen",function(e){"onOpen"in n.props&&"function"==typeof n.props.onOpen&&n._emit("open",n.props.list,function(t){n.props.onOpen(t,e)})}),_defineProperty(_assertThisInitialized(n),"_resetListScroll",function(){setTimeout(function(){n.listRef&&n.listRef.current&&(n.listRef.current.scrollTop=0)},250)}),_defineProperty(_assertThisInitialized(n),"closeOnBlurFn",function(e){if(n.props&&n.props.closeOnBlur&&(n._resetListScroll(),n.setState({defaultOpen:!1}),"mousedown"===n.state.revealOn&&n.state.open)){if(n._isDropdElem(e.path))return;n.closeDropd()}}),_defineProperty(_assertThisInitialized(n),"handleFocus",function(e){n.state.open||n.setState({open:!0},function(){n._emitOpen(e)})}),_defineProperty(_assertThisInitialized(n),"closeDropd",function(){n._resetListScroll(),n.setState({open:!1,defaultOpen:!1})}),_defineProperty(_assertThisInitialized(n),"handleItemChange",function(e,t){n.closeDropd(),n.setState({currentItem:e},function(){"onItemChange"in n.props&&"function"==typeof n.props.onItemChange&&n._emit("itemChange",n.state.currentItem,function(e){n.props.onItemChange(e,t)})})}),_defineProperty(_assertThisInitialized(n),"toggleDropd",function(e){e.persist(),n._resetListScroll(),n.setState(function(e){return{open:!e.open}},function(){n.state.open&&n._emitOpen(e)})}),n}_inheritsLoose(n,e);var t=n.prototype;return t.UNSAFE_componentWillMount=function(){var e=this,n=this.props,t=n.list,o=n.value;this.setState(function(n){return{revealOn:e.props.revealOn,list:[].concat(n.list,t),defaultOpen:e.props.defaultOpen,currentItem:o?o.label||o:null}})},t.componentDidMount=function(){this.props.defaultOpen&&(this._emitOpen(null),this.setState({open:!0})),"mousedown"===this.props.revealOn&&document.addEventListener("mousedown",this.closeOnBlurFn,!1)},t.UNSAFE_componentWillUpdate=function(e){e.revealOn!==this.state.revealOn?this.setState({revealOn:e.revealOn}):e.defaultOpen!==this.state.defaultOpen&&this.setState({defaultOpen:e.defaultOpen})},t.componentWillUnmount=function(){document.removeEventListener("mousedown",this.closeOnBlurFn,!1)},t.render=function(){var e=this,n=this.props.placeholder,t=this.state,o=t.list,r=t.currentItem,i=t.open,a=this.props,s=(a.value,a.onOpen,a.revealOn,a.closeOnBlur,a.defaultOpen,a.onItemChange,a.list,a.placeholder,_objectWithoutPropertiesLoose(a,["value","onOpen","revealOn","closeOnBlur","defaultOpen","onItemChange","list","placeholder"]));return React.createElement("div",_extends({},s,{dir:"auto","data-open":i,ref:this.dropdRef,className:"dropd react-dropd"}),React.createElement("button",{type:"button",tabIndex:"-1",className:"dropd-toggle",onMouseDown:function(n){return e.toggleDropd(n)}},React.createElement("input",{type:"search",autoComplete:"off",readOnly:"readonly",onBlur:this.closeDropd,style:{width:0,height:0,margin:0,padding:0,border:"0 none",outline:"0 none",textAlign:"unset",position:"absolute",WebkitAppearance:"none"},className:"dropd-fake-search",onFocus:function(n){return e.handleFocus(n)}}),!r&&n&&React.createElement("span",{className:"dropd-current is-placeholder"},n.label||n),r&&React.createElement("span",{className:"dropd-current"},r.label||r),React.createElement("span",{className:"dropd-caret","aria-hidden":!0},React.createElement("svg",{width:"6",height:"4",tabIndex:"-1",viewBox:"0 0 6 4",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},React.createElement("defs",null,React.createElement("path",{id:"a",tabIndex:"-1",d:"M132.047 389.564l.644-.537a.134.134 0 0 1 .091-.028.124.124 0 0 1 .085.042l2.134 2.438 2.133-2.438a.124.124 0 0 1 .085-.042.137.137 0 0 1 .091.028l.645.537c.025.021.04.05.043.083a.115.115 0 0 1-.03.088l-2.872 3.223a.127.127 0 0 1-.19 0l-2.873-3.223a.116.116 0 0 1-.03-.088.12.12 0 0 1 .044-.083z"})),React.createElement("use",{opacity:".7",fill:"#2c3c4f",xlinkHref:"#a",tabIndex:"-1",transform:"translate(-132 -389)"})))),React.createElement("ul",{ref:this.listRef,"aria-hidden":String(!i),className:"dropd-list"+(i?" open":"")},o&&o.map(function(n,t){return React.createElement("li",{key:t,tabIndex:"-1",className:"dropd-item",onMouseDown:function(t){return e.handleItemChange(n,t)}},React.createElement("a",{tabIndex:"-1",className:"dropd-link"},n.label||n))})))},n}(React.PureComponent);Dropd.propTypes={list:PropTypes.array,closeOnBlur:PropTypes.bool,defaultOpen:PropTypes.bool,onOpen:PropTypes.func,onItemChange:PropTypes.func,value:PropTypes.oneOfType([PropTypes.string,PropTypes.object]),placeholder:PropTypes.oneOfType([PropTypes.string,PropTypes.object]),revealOn:PropTypes.oneOf(["mousedown"])},Dropd.defaultProps={list:[],closeOnBlur:!0,defaultOpen:!1,value:null,placeholder:"Please select an item",revealOn:"mousedown"},module.exports=Dropd;
